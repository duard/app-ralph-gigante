{
  "permissions": {
    "allow": [
      "Bash(pnpm build:*)",
      "Bash(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}')",
      "Bash(curl -s -X GET 'http://localhost:3000/tgfpro/consumo-periodo/3680?dataInicio=2025-12-01&dataFim=2025-12-31' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOjMxMSwidXNlcm5hbWUiOiJDT05WSURBRE8iLCJlbWFpbCI6IiIsImlhdCI6MTc2ODA0MTEyMCwiZXhwIjoxNzY4MDQ0NzIwfQ.HmXgOkR7IljUys1Ga1vAM0sVoQ2qlgr_xfyKhHlLb5E\" | jq .)",
      "Bash(curl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOjMxMSwidXNlcm5hbWUiOiJDT05WSURBRE8iLCJlbWFpbCI6IiIsImlhdCI6MTc2ODA0MTEyMCwiZXhwIjoxNzY4MDQ0NzIwfQ.HmXgOkR7IljUys1Ga1vAM0sVoQ2qlgr_xfyKhHlLb5E\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"query\":\"SELECT TOP 5 CODPROD, DESCRPROD FROM TGFPRO WHERE CODPROD = 3680\",\"params\": []}' | jq .)",
      "Bash(curl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOjMxMSwidXNlcm5hbWUiOiJDT05WSURBRE8iLCJlbWFpbCI6IiIsImlhdCI6MTc2ODA0MTEyMCwiZXhwIjoxNzY4MDQ0NzIwfQ.HmXgOkR7IljUys1Ga1vAM0sVoQ2qlgr_xfyKhHlLb5E\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT COALESCE(SUM(CASE WHEN i.ATUALESTOQUE < 0 THEN -i.QTDNEG ELSE i.QTDNEG END), 0) AS saldo_qtd, COALESCE(SUM(CASE WHEN i.ATUALESTOQUE < 0 THEN -i.VLRTOT ELSE i.VLRTOT END), 0) AS saldo_valor FROM TGFCAB c JOIN TGFITE i ON i.NUNOTA = c.NUNOTA JOIN TGFTOP t ON t.CODTIPOPER = c.CODTIPOPER AND t.DHTIPOPER = c.DHTIPOPER WHERE i.CODPROD = 3680 AND c.STATUSNOTA = '\\''L'\\'' AND t.ATUALEST IN ('\\''B'\\'', '\\''E'\\'') AND COALESCE(c.DTENTSAI, c.DTNEG) < '\\''2025-12-01'\\''\",\n    \"params\": []\n  }' | jq .)",
      "Bash(curl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOjMxMSwidXNlcm5hbWUiOiJDT05WSURBRE8iLCJlbWFpbCI6IiIsImlhdCI6MTc2ODA0MTEyMCwiZXhwIjoxNzY4MDQ0NzIwfQ.HmXgOkR7IljUys1Ga1vAM0sVoQ2qlgr_xfyKhHlLb5E\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT COALESCE(SUM(CASE WHEN i.ATUALESTOQUE < 0 THEN -i.QTDNEG ELSE i.QTDNEG END), 0) AS saldo_qtd, COALESCE(SUM(CASE WHEN i.ATUALESTOQUE < 0 THEN -i.VLRTOT ELSE i.VLRTOT END), 0) AS saldo_valor FROM TGFCAB c JOIN TGFITE i ON i.NUNOTA = c.NUNOTA WHERE i.CODPROD = 3680 AND c.STATUSNOTA = '\\''L'\\'' AND i.ATUALESTOQUE <> 0 AND COALESCE(c.DTENTSAI, c.DTNEG) < '\\''2025-12-01'\\''\",\n    \"params\": []\n  }' | jq .)",
      "Edit(src/sankhya/tgfpro/consumo/**)",
      "Bash(ps aux | grep -E \"node|nest\" | grep -v grep)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\necho \"Token obtido: ${TOKEN:0:50}...\")",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\ncurl -s -X GET 'http://localhost:3000/tgfpro/consumo-periodo/3680?dataInicio=2025-12-01&dataFim=2025-12-31' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" | jq .)",
      "Write(**)",
      "Bash(mkdir -p /home/cazakino/zzz-ultra-gigante/api-sankhya-center/src/sankhya/tgfpro/consumo/sqls)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Testar o SQL com última compra\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"WITH UltimaCompra AS (SELECT TOP 1 i.VLRUNIT AS valor_unitario FROM TGFCAB c JOIN TGFITE i ON i.NUNOTA = c.NUNOTA WHERE i.CODPROD = 3680 AND c.STATUSNOTA = '\\''L'\\'' AND c.TIPMOV = '\\''C'\\'' AND i.ATUALESTOQUE > 0 AND COALESCE(c.DTENTSAI, c.DTNEG) < '\\''2025-12-01'\\'' ORDER BY COALESCE(c.DTENTSAI, c.DTNEG) DESC, c.NUNOTA DESC) SELECT 3680 AS codprod, uc.valor_unitario AS valor_referencia_ultima_compra, COALESCE(SUM(CASE WHEN i.ATUALESTOQUE < 0 THEN -i.QTDNEG ELSE i.QTDNEG END), 0) AS saldo_qtd, COALESCE(SUM(CASE WHEN i.ATUALESTOQUE < 0 THEN -i.QTDNEG ELSE i.QTDNEG END), 0) * uc.valor_unitario AS saldo_valor_com_ultima_compra, COALESCE(SUM(CASE WHEN i.ATUALESTOQUE < 0 THEN -i.VLRTOT ELSE i.VLRTOT END), 0) AS saldo_valor_acumulado_original FROM TGFCAB c JOIN TGFITE i ON i.NUNOTA = c.NUNOTA CROSS JOIN UltimaCompra uc WHERE i.CODPROD = 3680 AND c.STATUSNOTA = '\\''L'\\'' AND i.ATUALESTOQUE <> 0 AND i.RESERVA = '\\''N'\\'' AND COALESCE(c.DTENTSAI, c.DTNEG) < '\\''2025-12-01'\\'' GROUP BY uc.valor_unitario\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Testar com subquery simples\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT 3680 AS codprod, (SELECT TOP 1 i.VLRUNIT FROM TGFCAB c JOIN TGFITE i ON i.NUNOTA = c.NUNOTA WHERE i.CODPROD = 3680 AND c.STATUSNOTA = '\\''L'\\'' AND c.TIPMOV = '\\''C'\\'' AND i.ATUALESTOQUE > 0 AND COALESCE(c.DTENTSAI, c.DTNEG) < '\\''2025-12-01'\\'' ORDER BY COALESCE(c.DTENTSAI, c.DTNEG) DESC) AS valor_ultima_compra, COALESCE(SUM(CASE WHEN i.ATUALESTOQUE < 0 THEN -i.QTDNEG ELSE i.QTDNEG END), 0) AS saldo_qtd FROM TGFCAB c JOIN TGFITE i ON i.NUNOTA = c.NUNOTA WHERE i.CODPROD = 3680 AND c.STATUSNOTA = '\\''L'\\'' AND i.ATUALESTOQUE <> 0 AND i.RESERVA = '\\''N'\\'' AND COALESCE(c.DTENTSAI, c.DTNEG) < '\\''2025-12-01'\\''\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\ncurl -s -X GET 'http://localhost:3000/tgfpro/consumo-periodo/3680?dataInicio=2025-12-01&dataFim=2025-12-31' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" | jq '{\n    codprod,\n    dataInicio,\n    dataFim,\n    totalMovimentacoes,\n    saldoAnterior,\n    movimentoLiquido,\n    saldoAtual: {\n      tipo_registro: .saldoAtual.tipo_registro,\n      saldo_qtd_final: .saldoAtual.saldo_qtd_final,\n      saldo_valor_final_formatted: .saldoAtual.saldo_valor_final_formatted\n    }\n  }')",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# 1. Consultar estrutura completa de alguns produtos\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT TOP 5 CODPROD, DESCRPROD, COMPLDESC, CODVOL, ATIVO, USOPROD, CODGRUPOPROD, AD_TPPROD FROM TGFPRO WHERE ATIVO = '\\''S'\\'' ORDER BY CODPROD DESC\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Consultar estrutura básica de produtos\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT TOP 10 CODPROD, DESCRPROD, COMPLDESC, CODVOL, ATIVO, USOPROD, CODGRUPOPROD FROM TGFPRO WHERE ATIVO = '\\''S'\\'' ORDER BY CODPROD DESC\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Consultar estoque com controle\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT TOP 20 e.CODPROD, p.DESCRPROD, e.CODLOCAL, l.DESCRLOCAL, e.CONTROLE, e.ESTOQUE, e.CODPARC FROM TGFEST e JOIN TGFPRO p ON p.CODPROD = e.CODPROD LEFT JOIN TGFLOC l ON l.CODLOCAL = e.CODLOCAL WHERE e.ATIVO = '\\''S'\\'' AND e.ESTOQUE > 0 ORDER BY e.CODPROD DESC\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Consultar movimentações com controle\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT TOP 10 c.NUNOTA, c.TIPMOV, i.CODPROD, p.DESCRPROD, i.CONTROLE, i.QTDNEG, i.VLRUNIT FROM TGFCAB c JOIN TGFITE i ON i.NUNOTA = c.NUNOTA JOIN TGFPRO p ON p.CODPROD = i.CODPROD WHERE c.STATUSNOTA = '\\''L'\\'' AND i.CONTROLE IS NOT NULL AND i.CONTROLE <> '\\'''\\'' ORDER BY c.NUNOTA DESC\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Explorar TITCONTEST e LISTCONTEST em produtos\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT TOP 20 CODPROD, DESCRPROD, CONTROLE, TITCONTEST, LISTCONTEST FROM TGFPRO WHERE ATIVO = '\\''S'\\'' ORDER BY CODPROD DESC\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Buscar campos relacionados a controle no produto\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT TOP 1 * FROM TGFPRO WHERE CODPROD = 3680\",\n    \"params\": []\n  }' | jq . | head -100)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Buscar produtos com TIPCONTEST diferente de N\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT TOP 20 CODPROD, DESCRPROD, USOPROD, TIPCONTEST FROM TGFPRO WHERE TIPCONTEST <> '\\''N'\\'' AND ATIVO = '\\''S'\\'' ORDER BY CODPROD DESC\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Explorar valores possíveis de TIPCONTEST\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT DISTINCT TIPCONTEST, COUNT(*) as QTD FROM TGFPRO WHERE ATIVO = '\\''S'\\'' GROUP BY TIPCONTEST ORDER BY TIPCONTEST\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Buscar se existe LISTCONTEST\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT TOP 5 CODPROD, DESCRPROD, TIPCONTEST FROM TGFPRO WHERE TIPCONTEST = '\\''L'\\'' AND ATIVO = '\\''S'\\''\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Investigar produtos com controle tipo L (lote) - ver o campo CONTROLE em uso\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT TOP 10 p.CODPROD, p.DESCRPROD, p.TIPCONTEST, e.CONTROLE, e.ESTOQUE FROM TGFPRO p JOIN TGFEST e ON e.CODPROD = p.CODPROD WHERE p.TIPCONTEST = '\\''L'\\'' AND e.ESTOQUE > 0 AND e.CODPARC = 0\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Produtos com controle tipo S (série)\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT TOP 10 p.CODPROD, p.DESCRPROD, p.TIPCONTEST, e.CONTROLE, e.ESTOQUE FROM TGFPRO p JOIN TGFEST e ON e.CODPROD = p.CODPROD WHERE p.TIPCONTEST = '\\''S'\\'' AND e.ESTOQUE > 0 AND e.CODPARC = 0 AND e.CONTROLE IS NOT NULL AND e.CONTROLE <> '\\'''\\''\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Produtos com controle tipo E (endereço)\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT TOP 10 p.CODPROD, p.DESCRPROD, p.TIPCONTEST, e.CONTROLE, l.DESCRLOCAL, e.ESTOQUE FROM TGFPRO p JOIN TGFEST e ON e.CODPROD = p.CODPROD LEFT JOIN TGFLOC l ON l.CODLOCAL = e.CODLOCAL WHERE p.TIPCONTEST = '\\''E'\\'' AND e.ESTOQUE > 0 AND e.CODPARC = 0\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Ver como funciona a relação: produto com TIPCONTEST vs quantidade de registros em TGFEST\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT p.CODPROD, p.DESCRPROD, p.TIPCONTEST, COUNT(DISTINCT e.CONTROLE) as QTD_CONTROLES, COUNT(*) as LINHAS_TGFEST, SUM(e.ESTOQUE) as ESTOQUE_TOTAL FROM TGFPRO p JOIN TGFEST e ON e.CODPROD = p.CODPROD WHERE p.TIPCONTEST IN ('\\''S'\\'', '\\''L'\\'', '\\''E'\\'') AND e.CODPARC = 0 AND e.ATIVO = '\\''S'\\'' AND e.ESTOQUE > 0 GROUP BY p.CODPROD, p.DESCRPROD, p.TIPCONTEST ORDER BY QTD_CONTROLES DESC\",\n    \"params\": []\n  }' | jq '. | .[0:10]')",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Ver movimentações de um produto com controle tipo S\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT TOP 10 c.NUNOTA, c.TIPMOV, i.CODPROD, p.DESCRPROD, p.TIPCONTEST, i.CONTROLE, i.QTDNEG FROM TGFCAB c JOIN TGFITE i ON i.NUNOTA = c.NUNOTA JOIN TGFPRO p ON p.CODPROD = i.CODPROD WHERE p.TIPCONTEST = '\\''S'\\'' AND c.STATUSNOTA = '\\''L'\\'' AND i.CONTROLE IS NOT NULL AND i.CONTROLE <> '\\'''\\'' ORDER BY c.NUNOTA DESC\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Ver produto específico 1980 (Detergente) que tem múltiplos controles\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT e.CODPROD, p.DESCRPROD, p.TIPCONTEST, e.CODLOCAL, l.DESCRLOCAL, e.CONTROLE, e.ESTOQUE FROM TGFEST e JOIN TGFPRO p ON p.CODPROD = e.CODPROD LEFT JOIN TGFLOC l ON l.CODLOCAL = e.CODLOCAL WHERE e.CODPROD = 1980 AND e.CODPARC = 0 AND e.ATIVO = '\\''S'\\'' ORDER BY e.CONTROLE\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Testar endpoint V2\ncurl -s -X GET 'http://localhost:3000/tgfpro/consumo-periodo-v2/3680?dataInicio=2025-12-01&dataFim=2025-12-31' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Testar a query SQL do fetchProdutoInfo\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT CODPROD, DESCRPROD, COMPLDESC, CODVOL AS unidade, ATIVO, TIPCONTEST FROM TGFPRO WHERE CODPROD = 3680\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Testar query simplificada sem TGFTOP\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT TOP 1 c.NUNOTA, c.TIPMOV, c.CODTIPOPER FROM TGFCAB c JOIN TGFITE i ON i.NUNOTA = c.NUNOTA WHERE i.CODPROD = 3680 AND c.STATUSNOTA = '\\''L'\\'' AND COALESCE(c.DTENTSAI, c.DTNEG) BETWEEN '\\''2025-12-01'\\'' AND '\\''2025-12-31 23:59:59'\\''\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Testar com TGFTOP JOIN\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT TOP 1 c.NUNOTA, t.CODTIPOPER, t.DESCROPER FROM TGFCAB c JOIN TGFITE i ON i.NUNOTA = c.NUNOTA JOIN TGFTOP t ON t.CODTIPOPER = c.CODTIPOPER WHERE i.CODPROD = 3680 AND c.STATUSNOTA = '\\''L'\\''\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Testar com DHTIPOPER - descobrir se campo existe\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT TOP 1 CODTIPOPER, DHTIPOPER, DESCROPER FROM TGFTOP WHERE CODTIPOPER = 506\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Testar endpoint V2 novamente\ncurl -s -X GET 'http://localhost:3000/tgfpro/consumo-periodo-v2/3680?dataInicio=2025-12-01&dataFim=2025-12-31' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" | jq '{\n    produto,\n    periodo,\n    totalMovimentacoes,\n    saldoAnterior,\n    metrics,\n    \"primeira_movimentacao\": .movimentacoes[0]\n  }')",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Ver resposta completa\ncurl -s -X GET 'http://localhost:3000/tgfpro/consumo-periodo-v2/3680?dataInicio=2025-12-01&dataFim=2025-12-31' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\")",
      "Bash(sleep 3 && TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Testar V1 primeiro (deve funcionar)\ncurl -s -X GET 'http://localhost:3000/tgfpro/consumo-periodo/3680?dataInicio=2025-12-01&dataFim=2025-12-31' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" | jq '{codprod, totalMovimentacoes}')",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Testar query v2 completa\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT TOP 1 c.NUNOTA, c.TIPMOV, c.CODTIPOPER, t.DESCROPER, t.ATUALEST, c.CODCENCUS, i.CONTROLE FROM TGFCAB c JOIN TGFITE i ON i.NUNOTA = c.NUNOTA JOIN TGFTOP t ON t.CODTIPOPER = c.CODTIPOPER LEFT JOIN TSICUS cc ON cc.CODCENCUS = c.CODCENCUS WHERE i.CODPROD = 3680 AND c.STATUSNOTA = '\\''L'\\'' AND i.ATUALESTOQUE <> 0 AND i.RESERVA = '\\''N'\\'' AND COALESCE(c.DTENTSAI, c.DTNEG) BETWEEN '\\''2025-12-01'\\'' AND '\\''2025-12-31 23:59:59'\\''\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Testar sem TSICUS\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT TOP 1 c.NUNOTA, c.TIPMOV, c.CODTIPOPER, t.DESCROPER, t.ATUALEST, c.CODCENCUS, i.CONTROLE FROM TGFCAB c JOIN TGFITE i ON i.NUNOTA = c.NUNOTA JOIN TGFTOP t ON t.CODTIPOPER = c.CODTIPOPER WHERE i.CODPROD = 3680 AND c.STATUSNOTA = '\\''L'\\'' AND i.ATUALESTOQUE <> 0 AND i.RESERVA = '\\''N'\\'' AND COALESCE(c.DTENTSAI, c.DTNEG) BETWEEN '\\''2025-12-01'\\'' AND '\\''2025-12-31 23:59:59'\\''\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Testar TGFTOP com DTALTER\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT TOP 5 CODTIPOPER, DESCROPER, ATUALEST, DTALTER FROM TGFTOP ORDER BY DTALTER DESC\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Testar JOIN com CODTIPOPER e DTALTER\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT TOP 1 c.NUNOTA, c.CODTIPOPER, c.DTALTER, t.DESCROPER, t.ATUALEST FROM TGFCAB c JOIN TGFITE i ON i.NUNOTA = c.NUNOTA JOIN TGFTOP t ON t.CODTIPOPER = c.CODTIPOPER AND t.DTALTER = c.DTALTER WHERE i.CODPROD = 3680 AND c.STATUSNOTA = '\\''L'\\''\",\n    \"params\": []\n  }' | jq .)",
      "Bash(sleep 3 && TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Testar V2 após reload\ncurl -s -X GET 'http://localhost:3000/tgfpro/consumo-periodo-v2/3680?dataInicio=2025-12-01&dataFim=2025-12-31' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" | jq '{\n    produto,\n    periodo,\n    totalMovimentacoes,\n    saldoAnterior: {\n      tipoRegistro: .saldoAnterior.tipoRegistro,\n      saldoQtd: .saldoAnterior.saldoQtd,\n      valorUnitarioReferencia: .saldoAnterior.valorUnitarioReferencia\n    },\n    metrics,\n    \"primeira_mov\": .movimentacoes[0] | {\n      tipmov,\n      tipoOperacao,\n      controle,\n      quantidadeMov\n    }\n  }')",
      "Bash(ps aux | grep \"node.*dist/main\" | grep -v grep)",
      "Bash(curl -s http://localhost:3000 | head -20)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Ver resposta RAW do v2\ncurl -s -X GET 'http://localhost:3000/tgfpro/consumo-periodo-v2/3680?dataInicio=2025-12-01&dataFim=2025-12-31' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\")",
      "Bash(sleep 5 && TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Testar V2 sem TSICUS\ncurl -s -X GET 'http://localhost:3000/tgfpro/consumo-periodo-v2/3680?dataInicio=2025-12-01&dataFim=2025-12-31' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" | jq '{\n    produto,\n    periodo,\n    totalMovimentacoes,\n    \"primeira_mov\": .movimentacoes[0] | {tipoOperacao, controle, quantidadeMov}\n  }')",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Comparar V1 e V2\necho \"=== V1 ===\" && \\\ncurl -s -X GET 'http://localhost:3000/tgfpro/consumo-periodo/3680?dataInicio=2025-12-01&dataFim=2025-12-31' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" | jq '{totalMovimentacoes, saldoAnterior: .saldoAnterior.saldo_qtd}' && \\\necho \"=== V2 ===\" && \\\ncurl -s -X GET 'http://localhost:3000/tgfpro/consumo-periodo-v2/3680?dataInicio=2025-12-01&dataFim=2025-12-31' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" | jq '{totalMovimentacoes, saldoAnterior: .saldoAnterior.saldoQtd, metrics}')",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Verificar se TGFTOP tem múltiplas linhas por CODTIPOPER\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT CODTIPOPER, COUNT(*) as QTD FROM TGFTOP WHERE CODTIPOPER IN (500, 502, 504) GROUP BY CODTIPOPER\",\n    \"params\": []\n  }' | jq .)",
      "Bash(sleep 5 && TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Testar V2 com correção\necho \"=== V2 Corrigido ===\" && \\\ncurl -s -X GET 'http://localhost:3000/tgfpro/consumo-periodo-v2/3680?dataInicio=2025-12-01&dataFim=2025-12-31' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" | jq '{\n    totalMovimentacoes,\n    saldoAnterior: .saldoAnterior.saldoQtd,\n    metrics: {\n      totalConsumoBaixas: .metrics.totalConsumoBaixas,\n      totalSaidasQtd: .metrics.totalSaidasQtd,\n      percentualConsumo: .metrics.percentualConsumo\n    }\n  }')",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\ncurl -s -X GET 'http://localhost:3000/tgfpro/consumo-periodo-v2/3680?dataInicio=2025-12-01&dataFim=2025-12-31' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\")",
      "Bash(sleep 5 && TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Testar V2 final\ncurl -s -X GET 'http://localhost:3000/tgfpro/consumo-periodo-v2/3680?dataInicio=2025-12-01&dataFim=2025-12-31' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" | jq '{\n    produto,\n    periodo,\n    totalMovimentacoes,\n    saldoAnterior: {saldoQtd: .saldoAnterior.saldoQtd},\n    metrics: {totalSaidasQtd: .metrics.totalSaidasQtd},\n    \"primeira_mov\": .movimentacoes[0] | {tipoOperacao, controle}\n  }')",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Ver todas as versões do CODTIPOPER 500\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT CODTIPOPER, DESCROPER, ATUALEST, DTALTER FROM TGFTOP WHERE CODTIPOPER = 500 ORDER BY DTALTER DESC\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Ver campos de data em TGFTOP\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT TOP 1 * FROM TGFTOP WHERE CODTIPOPER = 500\",\n    \"params\": []\n  }' | jq . | head -50)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Testar JOIN correto: CODTIPOPER + data da movimentação\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT TOP 5 c.NUNOTA, c.CODTIPOPER, c.DTNEG, t.DESCROPER, t.DTALTER FROM TGFCAB c JOIN TGFITE i ON i.NUNOTA = c.NUNOTA LEFT JOIN TGFTOP t ON t.CODTIPOPER = c.CODTIPOPER AND c.DTNEG >= t.DTALTER WHERE i.CODPROD = 3680 AND c.STATUSNOTA = '\\''L'\\'' ORDER BY c.NUNOTA DESC\",\n    \"params\": []\n  }' | jq .)",
      "Bash(TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\n# Testar subquery para pegar TGFTOP da data correta\ncurl -s -X POST 'http://localhost:3000/inspection/query' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"SELECT TOP 3 c.NUNOTA, c.CODTIPOPER, c.DTNEG, (SELECT TOP 1 DESCROPER FROM TGFTOP WHERE CODTIPOPER = c.CODTIPOPER AND DHALTER <= c.DTNEG ORDER BY DHALTER DESC) AS DESCROPER FROM TGFCAB c JOIN TGFITE i ON i.NUNOTA = c.NUNOTA WHERE i.CODPROD = 3680 AND c.STATUSNOTA = '\\''L'\\'' ORDER BY c.NUNOTA DESC\",\n    \"params\": []\n  }' | jq .)",
      "Bash(sleep 3 && TOKEN=$(curl -s -X POST 'http://localhost:3000/auth/login' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"CONVIDADO\",\"password\":\"guest123\"}' | jq -r '.access_token')\n\ncurl -s -X GET 'http://localhost:3000/tgfpro/consumo-periodo-v2/3680?dataInicio=2025-12-01&dataFim=2025-12-31' \\\n  -H \"accept: application/json\" \\\n  -H \"Authorization: Bearer $TOKEN\" | jq '{\n    produto,\n    totalMovimentacoes,\n    saldoAnterior: {saldoQtd: .saldoAnterior.saldoQtd},\n    \"primeira_mov\": .movimentacoes[0] | {tipoOperacao, observacao, controle},\n    \"saldoAtual\": {saldoQtdFinal: .saldoAtual.saldoQtdFinal, qtdLocais: (.saldoAtual.localizacoes | length)}\n  }')"
    ]
  }
}
